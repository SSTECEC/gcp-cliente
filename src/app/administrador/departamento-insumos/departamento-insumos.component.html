
<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="ball-atom" [fullScreen]="true">
  <p style="color: white" > Cargando... </p>
</ngx-spinner>

<div class="page-wrapper chiller-theme sidebar-bg bg2 toggled border-radius-on">
  <main class="page-content pt-2">

      <app-menu [usuario]="usuario"></app-menu>

      <div class="container-fluid p-5">
          <div class="row">
              <div class="col-md-8">
                  <h4 class="page-title">Insumos</h4>
              </div>
              <div class="col-md-4" style="text-align: right !important;">
                  <ul class="breadcrumbs">
                      <li><a [routerLink]="['/administrador/sede']">GCP</a></li>
                      <li><span>Insumos</span></li>
                  </ul>
              </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-lg-12 mt-5">
              <div class="card">
                <div class="card-body">

                  <div class="form-row">
                    <div class="col-4"></div>
                    <div class="col-4"></div>
                    <div class="col-4">
                        <button type="button" class="btn btn-block btn-success" (click)="abrirModalAsignarInsumo()">
                          Asignar Insumos &nbsp;&nbsp;<i class="fas fa-list-ol fa-lg"></i>
                        </button>
                    </div>
                </div>

                <br><br>

                  <div class="table-responsive">
                    <table class="table table-hover table-bordered">
                        <thead class="text-uppercase thead-dark text-center">
                            <tr class="text-white">
                          <th scope="col">Sede</th>
                          <th scope="col">Piso</th>
                          <th scope="col">Secci贸n</th>
                          <th scope="col">C贸digo</th>
                          <th scope="col">Capacidad</th>
                          <th scope="col">Departamento</th>
                          <th scope="col">Tipo</th>
                          <th scope="col">Opciones</th>
                        </tr>
                      </thead>
                      <tbody class="text-center" style="vertical-align: middle;">
                        <tr *ngFor="let dato of lstDepartamentos">
                          <td style="vertical-align:middle !important;">{{ dato.nombreSede }}</td>
                          <td style="vertical-align:middle !important;">{{ dato.piso }}</td>
                          <td style="vertical-align:middle !important;">{{ dato.seccion }}</td>
                          <td style="vertical-align:middle !important;">{{ dato.codigo }}</td>
                          <td style="vertical-align:middle !important;">{{ dato.capacidad }}</td>
                          <td style="vertical-align:middle !important;">{{ dato.nombreDepartamento }}</td>
                          <td style="vertical-align:middle !important;">{{ dato.tipoDepartamento }}</td>
                          <td style="vertical-align:middle !important;">
                            <button class="btn btn-primary" (click)="listarDepartamentoInsumosDetalle(dato)">
                              <i class="far fa-list-alt fa-lg"></i>
                            </button>
                          </td>
                        </tr>
                        <tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
      </div>
  </main>
</div>

<div class="modal fade" id="ModalAsignarInsumos">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Gesti贸n Insumos</h5>
        <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
      </div>
      <div class="modal-body">

        <div>

          <div class="form-group">
            <div class="form-group">
              <label>Departamento</label>
              <select class="form-control" [(ngModel)]="formulario.idDepartamento">
                <option *ngFor="let dtDep of lstDepartamentos" value="{{ dtDep.idDepartamento }}">
                  {{ dtDep.codigo }} &nbsp;|&nbsp; {{ dtDep.seccion }} &nbsp;|&nbsp; {{ dtDep.nombreSede }} &nbsp;-&nbsp; {{ dtDep.nombreDepartamento }} &nbsp;&nbsp;&nbsp; ( {{ dtDep.tipoDepartamento }} ) 
                </option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <div class="form-group">
              <label>Insumo</label>
              <select class="form-control" [(ngModel)]="formulario.idInsumo" (ngModelChange)="buscarInsumoEspecifico(formulario.idInsumo)">
                <option *ngFor="let dtIn of lstInsumos" value="{{ dtIn.idInsumo }}">
                  {{ dtIn.nombre }}
                </option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>Cantidad</label>
            <input type="number" class="form-control" placeholder="Ingresar la cantidad del insumo" [(ngModel)]="formulario.cantidad" min="0" max="{{ limiteMax }}"
              (keyup)="formulario.cantidad = globales.formatoCampo(formulario.cantidad, '0123456789', 10, 2)" [readonly]="disabledCantidad">
          </div>

        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="guardarDepartamentoInsumos()">Guardar <i class="far fa-save"></i></button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="ModalDetalles">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Insumos Asignados</h5>
        <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
      </div>
      <div class="modal-body">
        <ul class="list-group list-group-flush" *ngFor="let dato of lstDatos">
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <h6>{{ dato.nombre }}</h6>
            <span class="badge badge-danger">{{ dato.cantidad }}</span>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="ModalDepartamentoInsumo">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Detalles Insumos Departamento</h5>
        <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
      </div>
      <div class="modal-body">

        <div class="form-group">
          <b>C贸digo</b><br>
          <span>{{ departamentoInsumo == undefined ? '' : departamentoInsumo.codigoInsumo }}</span>
        </div>
        <div class="form-group">
          <b>Aula</b><br>
          <span>{{ departamentoInsumo == undefined ? '' : departamentoInsumo.tipoDepartamento }}</span>
        </div>
        <div class="form-group">
          <b>Insumo</b><br>
          <span>{{ departamentoInsumo == undefined ? '' : departamentoInsumo.nombreInsumo }}</span>
        </div>
        <div class="form-group">
          <b>Estado Actual</b><br>
          <span>{{ departamentoInsumo == undefined ? '' : estado(departamentoInsumo.estado) }}</span>
        </div>
        <div class="form-group">
          <b>Nuevo Estado</b>
          <select class="form-control" [(ngModel)]="editar.estado">
            <option value="1">BUENO</option>
            <option value="2">SEMI BUENO</option>
            <option value="3">DADO DE BAJA</option>
          </select>

        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="actualizarEstadoDepartamentoInsumo()">Actualizar</button>
      </div>
    </div>
  </div>
</div>
