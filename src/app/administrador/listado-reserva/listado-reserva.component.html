<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="ball-atom" [fullScreen]="true">
    <p style="color: white"> Cargando... </p>
</ngx-spinner>

<div class="page-wrapper chiller-theme sidebar-bg bg2 toggled border-radius-on">
    <main class="page-content pt-2">

        <app-menu [usuario]="usuario"></app-menu>


        <div class="container-fluid p-5">

            <div class="row">
                <div class="col-md-8">
                    <h4 class="page-title">Listado de Reservas</h4>
                </div>
                <div class="col-md-4" style="text-align: right !important;">
                    <ul class="breadcrumbs">
                        <li><a [routerLink]="['/administrador/listar/reserva']">GCP</a></li>
                        <li><span>Lista Reservas</span></li>
                    </ul>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-lg-12 mt-5">
                    <div class="card">
                        <div class="card-body">

                            <div class="row">
                                <div class="col-md-8"></div>
                                <div class="col-md-4" style="text-align: right !important;">
                                    <h6><b><a data-toggle="collapse" (click)="abrirCollapse()" style="cursor: pointer !important;">Búsqueda Avanzada <i class="fa fa-search-plus"></i></a></b></h6><br>
                                </div>
                            </div>

                            <div class="collapse" id="collapseExample">
                                <div class="card card-body">

                                    <div class="row">

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label><b>Fecha</b></label>
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text bg-light text-white seleccion">
                                                            <input type="checkbox" name="parametro" value="1" checked>
                                                        </span>
                                                    </div>
                                                    <input type="date" class="form-control form-control-sm" [min]="fechaInicioMin" [(ngModel)]="fmrParametros.fecha">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label><b>Hora</b></label>
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span
                                                            class="input-group-text bg-light text-white seleccion">
                                                            <input type="checkbox" name="parametro" value="2">
                                                        </span>
                                                    </div>
                                                    <select class="custom-select form-control-sm" [(ngModel)]="fmrParametros.hora">
                                                        <option selected>Seleccione</option>
                                                        <option value="7">7:00</option>
                                                        <option value="8">8:00</option>
                                                        <option value="9">9:00</option>
                                                        <option value="10">10:00</option>
                                                        <option value="11">11:00</option>
                                                        <option value="12">12:00</option>
                                                        <option value="13">13:00</option>
                                                        <option value="14">14:00</option>
                                                        <option value="15">15:00</option>
                                                        <option value="16">16:00</option>
                                                        <option value="17">17:00</option>
                                                        <option value="18">18:00</option>
                                                        <option value="19">19:00</option>
                                                        <option value="20">20:00</option>
                                                        <option value="21">21:00</option>
                                                      </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label><b>Sede</b></label>
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span
                                                            class="input-group-text bg-light text-white seleccion">
                                                            <input type="checkbox" name="parametro" value="3">
                                                        </span>
                                                    </div>
                                                    <select class="custom-select form-control-sm" [(ngModel)]="fmrParametros.sede">
                                                        <option selected>Seleccione</option>
                                                        <option *ngFor="let sede of lstSedes" value="{{ sede.idSede }}">{{ sede.nombre }}</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label><b>Número Reserva</b></label>
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text bg-light text-white seleccion">
                                                            <input type="checkbox" name="parametro" value="4">
                                                        </span>
                                                    </div>
                                                    <input type="number" class="form-control form-control-sm" min="0" [(ngModel)]="fmrParametros.reserva">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label><b>Capacidad</b></label>
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span
                                                            class="input-group-text bg-light text-white seleccion">
                                                            <input type="checkbox" name="parametro" value="5">
                                                        </span>
                                                    </div>
                                                    <input type="number" class="form-control form-control-sm" min="0" [(ngModel)]="fmrParametros.capacidad">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-3"></div>

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label><b></b></label>
                                                <div class="input-group">
                                                    <button class="btn btn-outline-danger btn-block btn-sm" (click)="cerrarCollapse()"><b><i class="fa fa-times"> </i>&nbsp;&nbsp;Cerrar</b></button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label><b></b></label>
                                                <div class="input-group">
                                                    <button class="btn btn-outline-dark btn-block btn-sm" (click)="limpiarCollapse()"><b><i class="fa fa-eraser"> </i>&nbsp;&nbsp;Limpiar</b></button>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label><b></b></label>
                                                <div class="input-group">
                                                    <button class="btn btn-outline-info btn-block btn-sm" (click)="listarPagoParametros()"><b><i class="fa fa-search"> </i>&nbsp;&nbsp;Buscar</b></button>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                            <div class="d-flex justify-content-center">
                                <pagination-controls previousLabel="Anterior" nextLabel="Siguiente" responsive="true" (pageChange)="p = $event"></pagination-controls>
                              </div>
                              <br>
                            <div class="card" *ngFor="let reserva of this.lstReservas | paginate: { itemsPerPage: 30, currentPage: p } " [ngClass]="(reserva.idCatalogoEstado == 1 ) ? 'border-success' : 'border-warning'" style="margin-bottom: 15px !important;">
                                <div [ngClass]="(reserva.idCatalogoEstado == 1 ) ? 'card-header bg-success text-white' : 'card-header bg-warning'">
                                    <div class="form-row">
                                        <div class="col-md-6">
                                            <b> Reserva # {{reserva.idReserva}} </b> 
                                        </div>
                                        <div class="col-md-6" style="text-align: right !important;">
                                            <b>{{ reserva.ASIGNACION }}</b> 
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="form-row">
                                        <div class="col-md-3">
                                            <h6><b>Fecha: </b> {{ reserva.FECHARESERVA }}</h6>
                                        </div>
                                        <div class="col-md-9">
                                            <h6><b>Hora: </b>  {{ reserva.HORAINICIO }} : {{ reserva.HORAFIN }} </h6>
                                        </div>
                                        <br>
                                        <div class="col-md-3"><b>Sede: </b><span>{{ reserva.SEDE }}</span></div>
                                        <div class="col-md-2"><span><b>Sección: </b> {{ reserva.SECCION }}</span></div>
                                        <div class="col-md-1"><span><b>Piso: </b> {{ reserva.PISO }}</span></div>
                                        <div class="col-md-6"><span><b>Dirección: </b> {{ reserva.DIRECCION }}</span></div>
                                        <div class="col-md-3"><span><b>Departamento: </b> {{ reserva.TIPODEPARTAMENTO }}</span></div>
                                        <div class="col-md-3"><span><b>Nombre: </b> {{ reserva.NOMBREDEPARTAMENTO }}</span></div>
                                        <div class="col-md-3"><span><b>Código: </b> {{ reserva.CODIGODEPARTAMENTO }}</span></div>
                                        <div class="col-md-3"><span><b>Capacidad: </b> {{ reserva.CAPACIDAD }}</span></div>
                                        <div *ngIf="reserva.idCatalogoEstado == 2"  class="col-md-6"><span><b>Responsable: </b> {{ reserva.RESPONSABLE }}</span></div>
                                        <div *ngIf="reserva.idCatalogoEstado == 2"  class="col-md-3"><span><b>Cargo: </b> {{ reserva.CARGO }}</span></div>
                                        <div *ngIf="reserva.idCatalogoEstado == 2"  class="col-md-3"><span><b>Correo Electónico: </b> {{ reserva.EMAIL }}</span></div>
                                    </div>
                                </div>
                              </div>
                              <br>
                              <div class="d-flex justify-content-center">
                                <pagination-controls previousLabel="Anterior" nextLabel="Siguiente" responsive="true" (pageChange)="p = $event"></pagination-controls>
                              </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

</div>